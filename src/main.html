<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio Transcription</title>
  <link rel="stylesheet" href="styles/output.css">
</head>
<body class="m-0 p-0 overflow-hidden">
  <!-- App Container -->
  <div class="flex flex-col h-screen bg-animated-gradient text-white overflow-hidden" id="app">

    <!-- Custom Title Bar (macOS - draggable region) -->
    <div class="draggable h-14 flex-shrink-0 hidden" id="mac-title-bar"></div>

    <!-- Custom Title Bar (Windows Only) -->
    <div class="non-draggable hidden flex items-center justify-between px-4 h-12 bg-black/20 border-b border-white/10 backdrop-blur-md" id="custom-title-bar">
      <div class="flex items-center gap-2">
        <div class="w-5 h-5 opacity-80">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16zm-1-13h2v6h-2V7zm0 8h2v2h-2v-2z"/>
          </svg>
        </div>
        <span class="text-sm font-medium opacity-80">Audio Transcription</span>
      </div>
      <div class="flex items-center gap-1">
        <button class="non-draggable w-11 h-8 flex items-center justify-center hover:bg-white/10 transition-colors rounded" id="btn-minimize" aria-label="Minimize">
          <svg class="w-3 h-3" viewBox="0 0 10 1" fill="none">
            <rect width="10" height="1" fill="currentColor"/>
          </svg>
        </button>
        <button class="non-draggable w-11 h-8 flex items-center justify-center hover:bg-white/10 transition-colors rounded" id="btn-maximize" aria-label="Maximize">
          <svg class="w-3 h-3" viewBox="0 0 10 10" fill="none">
            <rect x="0" y="0" width="10" height="10" stroke="currentColor" stroke-width="1" fill="none"/>
          </svg>
        </button>
        <button class="non-draggable w-11 h-8 flex items-center justify-center hover:bg-error/80 transition-colors rounded" id="btn-close" aria-label="Close">
          <svg class="w-3 h-3" viewBox="0 0 10 10" fill="none">
            <path d="M0 0 L10 10 M10 0 L0 10" stroke="currentColor" stroke-width="1"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- App Header -->
    <header class="flex-shrink-0 backdrop-blur-xl bg-white/5 border-b border-white/10">
      <div class="flex items-center justify-between px-6 py-4">
        <!-- Mode Tabs -->
        <nav class="flex items-center gap-2 bg-white/5 rounded-xl p-1 backdrop-blur-sm" role="tablist" aria-label="App modes">
          <button
            class="tab-btn px-6 py-2.5 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 bg-white/20 text-white shadow-lg"
            id="tab-recording"
            role="tab"
            aria-selected="true"
            aria-controls="panel-recording"
            data-tab="recording"
          >
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"/>
              <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
              <line x1="12" y1="19" x2="12" y2="22"/>
            </svg>
            <span>Recording</span>
          </button>

          <button
            class="tab-btn px-6 py-2.5 rounded-lg font-medium text-sm transition-all duration-200 flex items-center gap-2 text-white/60 hover:text-white/80 hover:bg-white/5"
            id="tab-analysis"
            role="tab"
            aria-selected="false"
            aria-controls="panel-analysis"
            data-tab="analysis"
          >
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <line x1="10" y1="9" x2="8" y2="9"/>
            </svg>
            <span>Analysis</span>
          </button>
        </nav>

        <!-- Header Actions -->
        <div class="flex items-center gap-3">
          <!-- API Key Button -->
          <button
            class="relative p-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 transition-all duration-200 group"
            id="api-key-btn"
            aria-label="OpenAI API Key"
            data-status="missing"
            title="OpenAI API Key"
          >
            <svg class="w-5 h-5 transition-transform group-hover:rotate-12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
            </svg>
            <span class="status-indicator missing"></span>
          </button>

          <!-- Settings Button -->
          <button
            class="p-3 rounded-xl bg-white/5 hover:bg-white/10 border border-white/10 hover:border-white/20 transition-all duration-200 group"
            id="settings-btn"
            aria-label="Settings"
            title="Settings"
          >
            <svg class="w-5 h-5 transition-transform group-hover:rotate-90" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"/>
              <path d="M12 1v6m0 6v6M6 6l4.24 4.24m5.52 5.52L20 20M1 12h6m6 0h6M6 18l4.24-4.24m5.52-5.52L20 4"/>
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-hidden relative">

      <!-- Recording Tab Panel -->
      <div
        class="absolute inset-0 transition-opacity duration-300 opacity-100"
        id="panel-recording"
        role="tabpanel"
        aria-labelledby="tab-recording"
      >
        <!-- Blocking overlay when API key missing -->
        <div class="absolute inset-0 flex items-center justify-center bg-gradient-to-br from-gray-900/95 via-gray-800/95 to-gray-900/95 backdrop-blur-xl z-50 opacity-0 pointer-events-none transition-all duration-500" id="recording-blocked">
          <div class="text-center max-w-md px-8 animate-slide-up">
            <!-- Warning Icon with Pulse Animation -->
            <div class="inline-flex items-center justify-center w-20 h-20 mb-8 rounded-full bg-gradient-warning animate-pulse-slow">
              <svg class="w-10 h-10 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="8" x2="12" y2="12"/>
                <line x1="12" y1="16" x2="12.01" y2="16"/>
              </svg>
            </div>

            <!-- Title -->
            <h2 class="text-3xl font-bold mb-4 text-white">OpenAI API Key Required</h2>

            <!-- Description -->
            <p class="text-white/70 text-lg mb-8 leading-relaxed">
              To start transcribing audio, you'll need to add your OpenAI API key.
            </p>

            <!-- CTA Button -->
            <button class="group relative px-8 py-4 bg-gradient-accent text-white rounded-xl font-semibold text-base shadow-glass hover:shadow-glass-lg transition-all duration-300 hover:scale-105 overflow-hidden" id="add-api-key-btn">
              <span class="relative z-10">Add API Key</span>
              <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
            </button>

            <!-- Help Link -->
            <p class="mt-8 text-white/50 text-sm">
              Don't have one?
              <a href="https://platform.openai.com/api-keys" target="_blank" class="text-accent hover:text-accent-light transition-colors inline-flex items-center gap-1 ml-1">
                Get API Key from OpenAI
                <svg class="w-3 h-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                  <polyline points="15 3 21 3 21 9"/>
                  <line x1="10" y1="14" x2="21" y2="3"/>
                </svg>
              </a>
            </p>
          </div>
        </div>

        <!-- Recording interface (will be populated) -->
        <div class="h-full flex items-center justify-center p-8" id="recording-interface">
          <div class="text-center max-w-2xl">
            <h1 class="text-5xl font-bold mb-6 bg-gradient-to-r from-white via-white/90 to-white/70 bg-clip-text text-transparent">
              Audio Transcription
            </h1>
            <p class="text-white/60 text-xl mb-12">
              Upload a file or record audio directly.
            </p>
            <div class="glass rounded-2xl p-12 text-white/40 text-lg border-2 border-dashed border-white/20">
              Recording interface will go here...
            </div>
          </div>
        </div>
      </div>

      <!-- Analysis Tab Panel -->
      <div
        class="absolute inset-0 transition-opacity duration-300 opacity-0 pointer-events-none"
        id="panel-analysis"
        role="tabpanel"
        aria-labelledby="tab-analysis"
      >
        <div class="h-full flex items-center justify-center p-8">
          <div class="text-center">
            <div class="glass rounded-2xl p-12 text-white/40 text-lg border-2 border-dashed border-white/20">
              Analysis interface will go here...
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>

  <!-- API Key Modal -->
  <div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center p-4 opacity-0 pointer-events-none transition-all duration-300" id="api-key-modal">
    <div class="glass-dark rounded-2xl shadow-glass-lg max-w-lg w-full animate-scale-in border border-white/20" role="dialog" aria-labelledby="modal-title" aria-modal="true">
      <!-- Modal Header -->
      <div class="flex items-start justify-between p-6 border-b border-white/10">
        <div class="flex items-center gap-3">
          <div class="p-2 rounded-xl bg-gradient-accent">
            <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
            </svg>
          </div>
          <h2 id="modal-title" class="text-xl font-semibold">OpenAI API Key</h2>
        </div>
        <button class="p-2 hover:bg-white/10 rounded-lg transition-colors" id="modal-close" aria-label="Close">
          <svg class="w-5 h-5" viewBox="0 0 16 16" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4l8 8M12 4l-8 8"/>
          </svg>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="p-6 space-y-6">
        <!-- Input -->
        <div>
          <div class="relative">
            <input
              type="password"
              id="api-key-input"
              class="w-full px-4 py-3 bg-white/5 border border-white/20 rounded-xl text-white placeholder-white/40 focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all outline-none"
              placeholder="sk-proj-..."
              autocomplete="off"
              spellcheck="false"
              aria-describedby="api-key-help"
            />
            <div class="absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1">
              <button class="p-2 hover:bg-white/10 rounded-lg transition-colors" id="toggle-visibility" type="button" aria-label="Show API key">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
              </button>
              <button class="p-2 hover:bg-white/10 rounded-lg transition-colors" id="paste-btn" type="button" aria-label="Paste from clipboard">
                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Info Box -->
        <div class="flex items-start gap-3 p-4 bg-accent/10 border border-accent/20 rounded-xl" id="api-key-help">
          <svg class="w-5 h-5 text-accent flex-shrink-0 mt-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="16" x2="12" y2="12"/>
            <line x1="12" y1="8" x2="12.01" y2="8"/>
          </svg>
          <p class="text-sm text-white/80 leading-relaxed">
            Your API key is stored securely in your system
            <strong data-platform="darwin">keychain</strong>
            <strong data-platform="win32" class="hidden">Credential Manager</strong>
            and never leaves your device.
          </p>
        </div>

        <!-- Help Link -->
        <div class="text-center py-2">
          <p class="text-white/60 text-sm mb-2">Don't have an API key?</p>
          <a href="https://platform.openai.com/api-keys" target="_blank" class="inline-flex items-center gap-2 text-accent hover:text-accent-light transition-colors font-medium">
            Get API Key from OpenAI
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
              <polyline points="15 3 21 3 21 9"/>
              <line x1="10" y1="14" x2="21" y2="3"/>
            </svg>
          </a>
        </div>

        <!-- Validation Status -->
        <div class="hidden p-4 rounded-xl" id="validation-status">
          <!-- Dynamically populated -->
        </div>
      </div>

      <!-- Modal Footer -->
      <div class="flex items-center justify-end gap-3 p-6 border-t border-white/10">
        <button class="px-6 py-2.5 rounded-xl bg-white/5 hover:bg-white/10 border border-white/20 transition-all font-medium" id="cancel-api-key">
          Cancel
        </button>
        <button class="px-6 py-2.5 rounded-xl bg-gradient-accent hover:shadow-glass transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed" id="save-api-key" disabled>
          Save & Validate
        </button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="scripts/core/app.js"></script>
</body>
</html>
